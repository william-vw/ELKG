@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix log: <http://www.w3.org/2000/10/swap/log#> .
@prefix math: <http://www.w3.org/2000/10/swap/math#> .
@prefix list: <http://www.w3.org/2000/10/swap/list#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix tr: <http://rdf.org/trace#> .
@prefix pq: <http://notation3.org/pqn#> .
@prefix p2: <http://ocel2.org/p2p#> .
@prefix func: <http://www.w3.org/2007/rif-builtin-function#>.

# - lengthy approval process
# from https://www.ocel-standard.org/event-logs/simulations/p2p/:
# Lengthy Approval Process: Delays in approving purchase requisitions or purchase orders, which might lead to operational inefficiencies.

{
    ?t pq:activityOccurs ( "Create Purchase Order" ?c ) .
    ?t pq:activityOccurs ( "Approve Purchase Order" ?a ) .

    [] tr:event ?c ; tr:object ?o .
    ?o a p2:purchase_order .
    [] tr:event ?a ; tr:object ?o .

    ?c tr:ts ?cts . ?a tr:ts ?ats .

    ( ?ats ?cts ) func:subtract-dateTimes ?diff .
    ( ?diff ) func:days-from-duration ?days ;
        func:hours-from-duration ?hours .

    ( ?days 24 ) math:product ?days_hours .
    ( ?days_hours ?hours ) math:sum ?total_hours .

    ?total_hours math:greaterThan 168 # over 1 week

} => {
    pq:result pq:entry ( ?t ?c ?a ?total_hours )
} .